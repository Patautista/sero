@page "/shared-text-select/{EncodedText}"
@using MauiApp1.Components.Shared
@inject NavigationManager Navigation
@inherits SmartComponent

<div class="card-creation-container p-6 bg-white rounded-lg shadow-lg max-w-2xl mx-auto mb-4">
    <h2 class="text-2xl font-bold mb-6 text-indigo-700">
        <Translate Text="Texto Compartilhado"></Translate>
    </h2>

    <!-- Display shared text -->
    <div class="mb-6 p-4 bg-gray-50 rounded-lg border border-gray-300">
        <label class="block text-sm font-medium text-gray-700 mb-2">
            <Translate Text="Texto recebido"></Translate>
        </label>
        <p class="text-lg">@sharedText</p>
    </div>

    <!-- Action prompt -->
    <div class="mb-6 text-center">
        <p class="text-gray-700 mb-4">
            <Translate Text="O que você deseja fazer com este texto?"></Translate>
        </p>
    </div>

    <!-- Action buttons -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- Analyze Text -->
        <button @onclick="NavigateToAnalysis"
                class="flex flex-col items-center justify-center p-6 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-all shadow-lg hover:shadow-xl">
            <i class="fa fa-search text-4xl mb-3"></i>
            <span class="text-xl font-semibold mb-2">
                <Translate Text="Analisar Texto"></Translate>
            </span>
            <span class="text-sm opacity-90 text-center">
                <Translate Text="Ver análise detalhada com chunks e POS tags"></Translate>
            </span>
        </button>

        <!-- Create Card -->
        <button @onclick="NavigateToCreateCard"
                class="flex flex-col items-center justify-center p-6 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all shadow-lg hover:shadow-xl">
            <i class="fa fa-plus-circle text-4xl mb-3"></i>
            <span class="text-xl font-semibold mb-2">
                <Translate Text="Criar Cartão"></Translate>
            </span>
            <span class="text-sm opacity-90 text-center">
                <Translate Text="Adicionar diretamente ao deck"></Translate>
            </span>
        </button>
    </div>

    <!-- Cancel button -->
    <div class="mt-6 text-center">
        <button @onclick="GoBack"
                class="px-6 py-2 text-gray-600 hover:text-gray-800 transition-all">
            <i class="fa fa-arrow-left me-2"></i>
            <Translate Text="Voltar"></Translate>
        </button>
    </div>
</div>

@code {
    [Parameter]
    public string? EncodedText { get; set; }

    private string sharedText = string.Empty;

    protected override void OnInitialized()
    {
        base.OnInitialized();

        if (!string.IsNullOrWhiteSpace(EncodedText))
        {
            sharedText = Uri.UnescapeDataString(EncodedText);
        }
        else
        {
            // No text provided, redirect to home
            Navigation.NavigateTo("/");
        }
    }

    private void NavigateToAnalysis()
    {
        if (string.IsNullOrWhiteSpace(EncodedText))
            return;

        Navigation.NavigateTo($"{Routes.Analysis}/{EncodedText}");
    }

    private void NavigateToCreateCard()
    {
        if (string.IsNullOrWhiteSpace(EncodedText))
            return;

        Navigation.NavigateTo($"{Routes.CreateCard}/{EncodedText}");
    }

    private void GoBack()
    {
        Navigation.NavigateTo("/");
    }
}
