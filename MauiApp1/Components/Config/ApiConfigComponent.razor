@using Business.Interfaces
@inject ISettingsService SettingsService
@inject NavigationManager Nav

<EditForm Model="@ApiConfig" OnValidSubmit="ApplyConfig">
    <div class="font-bold">
        <h3 class="font-bold">Adicione aqui sua chave de api se possuir uma.</h3>
        <input @bind="ApiConfig.ApiKey" class="w-1/3 form-control mb-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all" type="text" name="apiKey" />

        <h3 class="font-bold mt-4">Base URL da API</h3>
        <input @bind="ApiConfig.BaseUrl" class="w-1/3 form-control mb-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all" type="text" name="baseUrl" />
    </div>

    <ButtonPrimary Type="submit">Salvar</ButtonPrimary>
</EditForm>

@code {
    public Business.MobileConfig.ApiConfig ApiConfig { get; set; } = new();

    protected override async Task OnInitializedAsync()
    {
        ApiConfig = SettingsService.ApiConfig.Value ?? new();
    }

    private async Task ApplyConfig()
    {

        ApiConfig.ApiKey = ApiConfig.ApiKey.Trim();
        ApiConfig.BaseUrl = ApiConfig.BaseUrl.Trim();
        SettingsService.ApiConfig.Update(ApiConfig);
        Nav.NavigateTo("/");
    }
}